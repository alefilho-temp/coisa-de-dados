use master
drop database Marketplace
CREATE DATABASE Marketplace
GO
USE Marketplace
GO
CREATE TABLE Cadastro (
    id INTEGER IDENTITY (1, 1),
    Email VARCHAR(50) NOT NULL,
    Lougradouro VARCHAR(50) NOT NULL,
    Numero INTEGER,
    Bairro VARCHAR(80),
    Cep INTEGER NOT NULL,
    PRIMARY KEY (id)
)
go
CREATE TABLE Telefone(
    Telefone INTEGER NOT NULL,
    CadastroId INTEGER NOT NULL,
    PRIMARY KEY(Telefone),
    FOREIGN KEY (CadastroId) REFERENCES Cadastro(id)
)
go
CREATE TABLE Carrinho(
    Codigo INTEGER NOT NULL,
	Valor_Total DECIMAL (6, 2) NOT NULL,
    PRIMARY KEY (Codigo)
)
go
CREATE TABLE Vendedor (
	Cadastro_id INTEGER PRIMARY KEY NOT NULL,
	Nome_Loja VARCHAR(255) not null,
	Informacao_loja VARCHAR(80)
	FOREIGN KEY (Cadastro_id) REFERENCES Cadastro(id)
)
go
CREATE TABLE Vendedor_Pessoal (
	CPF INTEGER NOT NULL,
	VendedorCadastro_id INTEGER NOT NULL,
	Nome VARCHAR(80) NOT NULL,
	Data_Nascimento DATE NOT NULL,
	Inscricao_Estadual VARCHAR(50) NOT NULL
	PRIMARY KEY (CPF, VendedorCadastro_id),
	FOREIGN KEY (VendedorCadastro_id) REFERENCES Vendedor(Cadastro_id)
	)
	go
CREATE TABLE Vendedor_Empresarial(
    CNPJ INTEGER NOT NULL,
    VendedorCadastro_id INTEGER NOT NULL,
    Razao_Social VARCHAR(100) NOT NULL,
    Informacao_cobranca VARCHAR(50) NOT NULL,
    PRIMARY KEY(CNPJ, VendedorCadastro_id),
	FOREIGN KEY (VendedorCadastro_id) REFERENCES Vendedor(Cadastro_id)
)
go
CREATE TABLE Categoria (
	Id INTEGER PRIMARY KEY IDENTITY (1, 1),
	Nome VARCHAR(30) NOT NULL,
	Cor VARCHAR(20) NOT NULL,
	Imagem VARCHAR(255) NOT NULL
)
go
CREATE TABLE Produto (
	Id_Produto INTEGER NOT NULL IDENTITY(1, 1) PRIMARY KEY,
	quantidade INTEGER NOT NULL,
	preco_Unitario	DECIMAL(6, 2) NOT NULL,
	nome VARCHAR(100) NOT NULL,
	descricao VARCHAR(2000),
	VendedorCadastro_id INTEGER NOT NULL,
	CategoriaId INTEGER NOT NULL,
	Imagem VARCHAR(255) NOT NULL
	FOREIGN KEY (VendedorCadastro_id) REFERENCES Vendedor(Cadastro_id),
	FOREIGN KEY (CategoriaId) REFERENCES Categoria(Id)
)
go
CREATE TABLE Cliente(
    CPF INTEGER NOT NULL,
    Nome_Usuario VARCHAR(80) NOT NULL,
    Nome VARCHAR(80) NOT NULL,
    Genero VARCHAR(30) NOT NULL,
    Data_Nascimento DATE NOT NULL,
    CadastroId INTEGER NOT NULL,
	CarrinhoCodigo INTEGER NOT NULL,
    PRIMARY KEY (CPF, CadastroId),
    FOREIGN KEY (CadastroId) REFERENCES Cadastro(Id),
	FOREIGN KEY (CarrinhoCodigo) REFERENCES Carrinho(Codigo),
)
go
INSERT INTO Cliente (CPF, Nome_Usuario, Nome, Genero, Data_Nascimento, CadastroId, CarrinhoCodigo) 
CREATE Table Cartao (
	Numero INTEGER PRIMARY KEY NOT NULL,
	Data_Vencimento DATE NOT NULL,
	Codigo_Seguranca INTEGER NOT NULL,
	Tipo VARCHAR(255) NOT NULL,
	Nome_Cartao VARCHAR(255) NOT NULL,
	ClienteCPF INTEGER NOT NULL,
	ClienteCadastroId INT NOT NULL,
	FOREIGN KEY (ClienteCPF, ClienteCadastroId) REFERENCES Cliente(CPF, CadastroId)
)
go
CREATE TABLE Cupon(
    Numero_Cupon INTEGER NOT NULL,
    ClienteCPF INTEGER NOT NULL,
	ClienteCadastroId INTEGER NOT NULL,
    Porcentagem_Desconto INTEGER NOT NULL,
    PRIMARY KEY (Numero_Cupon),
    FOREIGN KEY (ClienteCPF, ClienteCadastroId) REFERENCES Cliente(CPF, CadastroId)
)
go
CREATE TABLE Compra(
	Codigo INTEGER NOT NULL,
	ProdutoId_Produto INTEGER NOT NULL,
	ClienteCPF INTEGER NOT NULL,
	ClienteCadastroId INTEGER NOT NULL,
	DataCompra DATE NOT NULL,
	Quantidade_comprada INTEGER NOT NULL,
	PRIMARY KEY (Codigo, ProdutoId_Produto, ClienteCPF, ClienteCadastroId),
	FOREIGN KEY (ClienteCPF, ClienteCadastroId) REFERENCES Cliente(CPF, CadastroId),
)
go
CREATE TABLE Produto_Carrinho(
    ProdutoId_Produto INTEGER,
    CarrinhoCodigo INTEGER,
	Quantidade_Carrinho INTEGER NOT NULL,
    FOREIGN KEY (ProdutoId_Produto) REFERENCES Produto(id_Produto),
    FOREIGN KEY (CarrinhoCodigo) REFERENCES Carrinho(Codigo)
)
go

INSERT INTO Cadastro (Email, Lougradouro, Numero, Bairro, Cep)
VALUES 
('email1@gmail.com', 'Rua A', 123, 'Centro', 12345),
('email2@gmail.com', 'Rua B', 456, 'Bairro 1', 23456),
('email3@gmail.com', 'Rua C', 789, 'Bairro 2', 34567),
('email4@gmail.com', 'Rua D', 101, 'Centro', 45678),
('email5@gmail.com', 'Rua E', 102, 'Bairro 3', 56789);

INSERT INTO Telefone (Telefone, CadastroId)
VALUES 
(11111111, 1), 
(22222222, 2), 
(33333333, 3), 
(44444444, 4), 
(55555555, 5);

INSERT INTO Carrinho (Codigo, Valor_Total)
VALUES 
(1, 150.50), 
(2, 200.00), 
(3, 350.75), 
(4, 400.10), 
(5, 500.30);

INSERT INTO Vendedor (Cadastro_id, Nome_Loja, Informacao_loja)
VALUES 
(1, 'Loja A', 'Informação A'), 
(2, 'Loja B', 'Informação B'), 
(3, 'Loja C', 'Informação C'), 
(4, 'Loja D', 'Informação D'), 
(5, 'Loja E', 'Informação E');

INSERT INTO Vendedor_Pessoal (CPF, VendedorCadastro_id, Nome, Data_Nascimento, Inscricao_Estadual)
VALUES 
(123456789, 1, 'João', '1990-01-01', 'IS12345'),
(987654321, 2, 'Maria', '1985-05-10', 'IS54321'),
(456789123, 3, 'Pedro', '1995-12-15', 'IS67890'),
(321654987, 4, 'Ana', '1988-07-20', 'IS98765'),
(789123456, 5, 'Carlos', '1992-03-25', 'IS34567');

INSERT INTO Categoria (Nome, Cor, Imagem)
VALUES 
('Azul', '1435', 'i1'),
('Vermelho', '1435', 'i1'),
('Verde', '1435', 'i1'),
('Ciano', '1435', 'i1'),
('Laranja', '1435', 'i1')


INSERT INTO Produto (quantidade, preco_Unitario, nome, descricao, VendedorCadastro_id, CategoriaId, Imagem)
VALUES 
(10, 20.50, 'Produto A', 'Descrição A', 1, 1, 'imagemA.png'),
(15, 30.00, 'Produto B', 'Descrição B', 2, 2, 'imagemB.png'),
(20, 25.75, 'Produto C', 'Descrição C', 3, 3, 'imagemC.png'),
(25, 35.50, 'Produto D', 'Descrição D', 4, 4, 'imagemD.png'),
(30, 40.00, 'Produto E', 'Descrição E', 5, 5, 'imagemE.png');

INSERT INTO Cliente (CPF, Nome_Usuario, Nome, Genero, Data_Nascimento, CadastroId, CarrinhoCodigo)  
VALUES 
(111111111, 'user1', 'João Silva', 'Masculino', '1990-01-01', 1, 1),
(222222222, 'user2', 'Maria Santos', 'Feminino', '1985-02-15', 2, 2),
(333333333, 'user3', 'Pedro Almeida', 'Masculino', '1995-03-20', 3, 3),
(444444444, 'user4', 'Ana Oliveira', 'Feminino', '1992-04-25', 4, 4),
(555555555, 'user5', 'Carlos Souza', 'Masculino', '1988-05-30', 5, 5);

INSERT INTO Cupon (Numero_Cupon, ClienteCPF, ClienteCadastroId, Porcentagem_Desconto)  
VALUES 
(1, 111111111, 1, 10),
(2, 222222222, 2, 15),
(3, 333333333, 3, 20),
(4, 444444444, 4, 25),
(5, 555555555, 5, 30);

INSERT INTO Compra (Codigo, ProdutoId_Produto, ClienteCPF, ClienteCadastroId, DataCompra, Quantidade_comprada)  
VALUES 
(1, 1, 111111111, 1, '2024-11-20', 2),
(2, 2, 222222222, 2, '2024-11-21', 3),
(3, 3, 333333333, 3, '2024-11-22', 1),
(4, 4, 444444444, 4, '2024-11-23', 5),
(5, 5, 555555555, 5, '2024-11-24', 4);

alter table Produto add Desconto int